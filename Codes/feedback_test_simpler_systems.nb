(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     38871,       1051]
NotebookOptionsPosition[     36452,       1007]
NotebookOutlinePosition[     36858,       1023]
CellTagsIndexPosition[     36815,       1020]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Calculate the feedback Riccati Equations and Attempt a Symbolic Solution\
\>", "Text",
 CellChangeTimes->{{3.8618167906175156`*^9, 3.861816846914514*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"54324ec4-901a-43d0-a10a-39ff29734a3f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", " ", "=", " ", "1"}], ";", 
  RowBox[{"l", " ", "=", " ", "1"}], ";", " ", 
  RowBox[{"M", " ", "=", " ", "1"}], ";", 
  RowBox[{"m", " ", "=", " ", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ldynamics", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", "*", 
     RowBox[{"(", 
      RowBox[{"M", "+", "m"}], ")"}], "*", 
     RowBox[{"x2", "^", "2"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", "*", "m", "*", 
     RowBox[{"l", "^", "2"}], "*", 
     RowBox[{"\[Theta]2", "^", "2"}]}], " ", "+", " ", 
    RowBox[{"m", "*", "l", "*", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}], "*", "x2", "*", "\[Theta]2"}], 
    " ", "+", " ", 
    RowBox[{"m", "*", "g", "*", "l", "*", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], " ", "-", " ", 
    RowBox[{"u", "*", "x1"}]}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Note", ":", " ", 
    RowBox[{
    "u", " ", "is", " ", "a", " ", "scaled", " ", "version", " ", "of", " ", 
     "the", " ", "original", " ", "control", " ", "by", " ", "a", " ", 
     "factor", " ", "of", " ", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"M", "+", "m"}], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"fdot", "[", "s_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"s", ",", "x1"}], "]"}], "*", "x2"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"s", ",", "x2"}], "]"}], "*", "x2dot"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"s", ",", "\[Theta]1"}], "]"}], "*", "\[Theta]2"}], " ", "+", 
    " ", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"s", ",", "\[Theta]2"}], "]"}], "*", "\[Theta]2dot"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqn1", " ", "=", " ", 
   RowBox[{
    RowBox[{"fdot", "[", 
     RowBox[{"D", "[", 
      RowBox[{"Ldynamics", ",", "x2"}], "]"}], "]"}], " ", "-", " ", 
    RowBox[{"D", "[", 
     RowBox[{"Ldynamics", ",", "x1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqn2", " ", "=", " ", 
   RowBox[{
    RowBox[{"fdot", "[", 
     RowBox[{"D", "[", 
      RowBox[{"Ldynamics", ",", "\[Theta]2"}], "]"}], "]"}], " ", "-", " ", 
    RowBox[{"D", "[", 
     RowBox[{"Ldynamics", ",", "\[Theta]1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x2dot", ",", "\[Theta]2dot"}], "}"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"SolveValues", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eqn1", "==", "0"}], ",", 
        RowBox[{"eqn2", " ", "==", " ", "0"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2dot", ",", "\[Theta]2dot"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fx", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x2", ",", "x2dot", ",", "\[Theta]2", ",", "\[Theta]2dot"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2", ",", "\[Theta]1", ",", "\[Theta]2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3", ",", "\[Lambda]4"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    RowBox[{"u", "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Af", " ", "=", " ", 
   RowBox[{"Grad", "[", 
    RowBox[{"fx", ",", "x"}], "]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"For", " ", "nD", " ", "stuff", " ", "use", " ", "Grad"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Bf", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"fx", ",", "u"}], "]"}]}], " ", ";", 
  RowBox[{"(*", 
   RowBox[{"For", " ", "1", "D", " ", "stuff", " ", "use", " ", "D"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"Q", " ", "=", " ", 
   RowBox[{"Grad", "[", 
    RowBox[{
     RowBox[{"Grad", "[", 
      RowBox[{"L", ",", "x"}], "]"}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mf", " ", "=", " ", 
   RowBox[{"Grad", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"L", ",", "u"}], "]"}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"L", ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", " ", "=", " ", 
    RowBox[{"(", GridBox[{
       {"s11", "s12", "s13", "s14"},
       {"s12", "s22", "s23", "s24"},
       {"s13", "s23", "s33", "s34"},
       {"s14", "s24", "s34", "s44"}
      }], ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ric", " ", "=", " ", 
     RowBox[{"Q", " ", "+", "  ", 
      RowBox[{
       RowBox[{"Af", "\[Transpose]"}], ".", "S"}], " ", "+", 
      RowBox[{"S", ".", "Af"}], " ", "-", 
      RowBox[{"Outer", "[", 
       RowBox[{"Times", ",", 
        RowBox[{"S", ".", "Bf"}], ",", 
        RowBox[{
         RowBox[{"Bf", "\[Transpose]"}], ".", "S"}]}], " ", "]"}]}]}], " ", 
    ";"}], "  ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ric", " ", "=", " ", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "4", "]"}], " ", "+", "  ", 
    RowBox[{
     RowBox[{"Af", "\[Transpose]"}], ".", "S"}], " ", "+", 
    RowBox[{"S", ".", "Af"}], " ", "-", 
    RowBox[{"Outer", "[", 
     RowBox[{"Times", ",", 
      RowBox[{"S", ".", "Bf"}], ",", 
      RowBox[{
       RowBox[{"Bf", "\[Transpose]"}], ".", "S"}]}], " ", "]"}]}]}], " ", ";",
   " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "is", " ", "the", " ", "Syntax", " ", "for", " ", 
    "calculating", " ", "Outer", " ", "Products"}], " ", "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"M", " ", "=", " ", "0"}], ",", " ", 
    RowBox[{"R", " ", "=", " ", "1"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"RHS", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", " ", "=", " ", 
   RowBox[{"SolveValues", "[", 
    RowBox[{
     RowBox[{"ric", "==", "RHS"}], ",", 
     RowBox[{"Flatten", "@", "S"}]}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.861713638037676*^9, 3.861713671719797*^9}, {
   3.8617137545970287`*^9, 3.861713801379919*^9}, {3.86171396804309*^9, 
   3.861714008976869*^9}, 3.8617140555088396`*^9, {3.861716315929761*^9, 
   3.8617163270351734`*^9}, {3.8618075061663446`*^9, 3.86180750634029*^9}, {
   3.8618079995985646`*^9, 3.8618080121175613`*^9}, {3.861814359959751*^9, 
   3.861814437915826*^9}, {3.8618144720479107`*^9, 3.861814480742131*^9}, {
   3.8618147950736194`*^9, 3.861814819151919*^9}, {3.8619052578884764`*^9, 
   3.8619053066279044`*^9}},ExpressionUUID->"4663411f-0ad4-4651-90dc-\
0e8ed44cc4d4"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.861905310285736*^9},
 CellLabel->
  "Out[1487]=",ExpressionUUID->"7d8d1e67-3db0-49ef-a8ac-ef6a2d2bb224"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8618173983072004`*^9, 
  3.861817398316198*^9}},ExpressionUUID->"5f3d49a9-c4b6-4245-8de3-\
4c1154717fd3"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.861125609335279*^9, 3.861125750905754*^9}, {
   3.861126819319172*^9, 3.861126822821048*^9}, {3.861126921796218*^9, 
   3.8611269764006577`*^9}, {3.8611271027930136`*^9, 
   3.8611271032638626`*^9}, {3.861127228426612*^9, 3.8611272944263864`*^9}, {
   3.86112743012675*^9, 3.8611274335866356`*^9}, {3.8611282385107875`*^9, 
   3.8611282416817713`*^9}, {3.8611282805302753`*^9, 3.8611283044085965`*^9}, 
   3.861130508136922*^9, {3.861130542932733*^9, 3.861130565680416*^9}, {
   3.861131467121534*^9, 3.8611314674274316`*^9}, {3.8611317432527337`*^9, 
   3.861131744014488*^9}, {3.861216545193239*^9, 3.8612165481432967`*^9}, 
   3.8617163539964657`*^9, 
   3.86180750421497*^9},ExpressionUUID->"3f24608d-a622-4a00-ab08-\
ef45c75a1135"],

Cell["\<\
Generic Function to Calculate Feedback Symbolically given state space \
equations\
\>", "Text",
 CellChangeTimes->{{3.8618145120221276`*^9, 3.8618145309990597`*^9}, {
   3.86190422955396*^9, 3.8619042457257943`*^9}, 3.8619047725595055`*^9},
 Background->GrayLevel[
  0.85],ExpressionUUID->"818f44b8-eb81-448e-9c89-8e55e178d38f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"feedbackCalSymbolic", "[", 
   RowBox[{"n_", ",", "x_", ",", "fx_", ",", "L_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Af", ",", "Bf", ",", "Mf", ",", "Q", ",", "R", ",", "S", ",", "ric", 
      ",", "RHS", ",", "zero"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Af", " ", "=", " ", 
      RowBox[{"Grad", "[", 
       RowBox[{"fx", ",", "x"}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"For", " ", "nD", " ", "stuff", " ", "use", " ", "Grad"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Bf", " ", "=", " ", 
      RowBox[{"D", "[", 
       RowBox[{"fx", ",", "u"}], "]"}]}], " ", ";", 
     RowBox[{"(*", 
      RowBox[{"For", " ", "1", "D", " ", "stuff", " ", "use", " ", "D"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Q", " ", "=", " ", 
      RowBox[{"Grad", "[", 
       RowBox[{
        RowBox[{"Grad", "[", 
         RowBox[{"L", ",", "x"}], "]"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mf", " ", "=", " ", 
      RowBox[{"Grad", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"L", ",", "u"}], "]"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"R", " ", "=", " ", 
      RowBox[{"D", "[", 
       RowBox[{"L", ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myMatrix", "[", 
       RowBox[{"a_Integer", ",", "b_Integer"}], "]"}], ":=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"s", ",", "i", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "a"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "b"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"S", " ", "=", " ", 
      RowBox[{"myMatrix", "[", 
       RowBox[{"n", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", 
       RowBox[{"i", "<=", "n"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"j", " ", "<=", " ", "n"}], ",", 
         RowBox[{"j", " ", "++"}], " ", ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", " ", "!=", " ", "j"}], ",", " ", 
           RowBox[{
            SubscriptBox["s", 
             RowBox[{"i", ",", "j", " "}]], "=", " ", 
            SubscriptBox["s", 
             RowBox[{"j", ",", "i"}]]}], ",", "_"}], "]"}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ric", " ", "=", " ", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "2", "]"}], " ", "+", "  ", 
       RowBox[{
        RowBox[{"Af", "\[Transpose]"}], ".", "S"}], " ", "+", 
       RowBox[{"S", ".", "Af"}], " ", "-", 
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", 
         RowBox[{"S", ".", "Bf"}], ",", 
         RowBox[{
          RowBox[{"Bf", "\[Transpose]"}], ".", "S"}]}], " ", "]"}]}]}], " ", 
     ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "This", " ", "is", " ", "the", " ", "Syntax", " ", "for", " ", 
       "calculating", " ", "Outer", " ", "Products"}], " ", "*)"}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"M", " ", "=", " ", "0"}], ",", " ", 
       RowBox[{"R", " ", "=", " ", "1"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"RHS", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"S", " ", "=", " ", 
      RowBox[{
       RowBox[{"SolveValues", "[", 
        RowBox[{
         RowBox[{"ric", "==", "RHS"}], ",", 
         RowBox[{"Flatten", "@", "S"}]}], "]"}], "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
     "S"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.861807089580555*^9, 3.861807169738923*^9}, {
   3.861807496056577*^9, 3.8618075587895193`*^9}, {3.861807838985921*^9, 
   3.8618079124424343`*^9}, {3.861807968761425*^9, 3.861807970877747*^9}, {
   3.8618080236568713`*^9, 3.8618080723003197`*^9}, {3.8618081042810907`*^9, 
   3.86180810528277*^9}, {3.8618081727332025`*^9, 3.8618082082938304`*^9}, {
   3.8618135296132665`*^9, 3.8618135397270327`*^9}, {3.8618136072624364`*^9, 
   3.861813613508439*^9}, {3.8618136536715984`*^9, 3.861813793601855*^9}, {
   3.8618138350066137`*^9, 3.8618138781398215`*^9}, {3.8618139562668376`*^9, 
   3.8618139798203077`*^9}, {3.8618143129397883`*^9, 
   3.8618143169325113`*^9}, {3.8619042065393114`*^9, 3.861904213055229*^9}, 
   3.861905330823176*^9},
 CellLabel->
  "In[1488]:=",ExpressionUUID->"62e43d9e-55cf-4f52-8714-78cd6c09b05f"],

Cell["Testing", "Text",
 CellChangeTimes->{{3.8618145120221276`*^9, 3.8618145309990597`*^9}, {
  3.8619041354490204`*^9, 3.86190414164804*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"67fe12fe-b684-4f90-a08d-a3eca45f658c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"S", "=", " ", 
   RowBox[{"feedbackCalSymbolic", "[", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", "x2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "x1", "]"}]}], " ", "+", " ", "u"}]}], "}"}], 
     ",", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"u", "^", "2"}]}]}], "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.861807568530404*^9, 3.861807624995352*^9}, {
   3.8618077584176855`*^9, 3.861807796140624*^9}, {3.8618080799218807`*^9, 
   3.861808080124813*^9}, {3.8618081371925673`*^9, 3.8618081372825384`*^9}, {
   3.8618082908644266`*^9, 3.8618083220994406`*^9}, {3.8618143244451094`*^9, 
   3.861814324781003*^9}, 3.8619042196351285`*^9},
 CellLabel->
  "In[1491]:=",ExpressionUUID->"3bc90743-56a5-4b59-a2ba-a0a7287f307e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SqrtBox[
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"Cos", "[", "x1", "]"}], "2"]}]], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      RowBox[{"2", " ", 
       RowBox[{"Cos", "[", "x1", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "x1", "]"}], "2"]}]]}]}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Cos", "[", "x1", "]"}]}], "+", 
    SqrtBox[
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"Cos", "[", "x1", "]"}], "2"]}]]}], ",", 
   SqrtBox[
    RowBox[{"1", "-", 
     RowBox[{"2", " ", 
      RowBox[{"Cos", "[", "x1", "]"}]}], "+", 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "x1", "]"}], "2"]}]]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.861813993172037*^9, 3.861814328526802*^9, 
  3.861904223386928*^9, 3.8619053356836233`*^9},
 CellLabel->
  "Out[1491]=",ExpressionUUID->"6e376ed8-6fea-4439-a1c9-11b39911f128"]
}, Open  ]],

Cell["\<\
Generic Function to Calculate Feedback Numerically given state space equations\
\>", "Text",
 CellChangeTimes->{{3.8618145120221276`*^9, 3.8618145309990597`*^9}, {
  3.86181689308575*^9, 3.861816904411129*^9}, {3.861904159808238*^9, 
  3.8619041607829266`*^9}, {3.861904250605235*^9, 3.8619042559395304`*^9}, {
  3.861904768432824*^9, 3.8619047694474993`*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"065995be-0efc-4a4c-9d29-cbdd8ba9291d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"feedbackCalNumeric", "[", 
   RowBox[{"n_", ",", "x_", ",", "fx_", ",", "L_", ",", "x0_"}], "]"}], " ", ":=",
   " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Af", ",", "Bf", ",", "Mf", ",", "Q", ",", "R", ",", "S", ",", "ric", 
      ",", "RHS", ",", "zero"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Af", " ", "=", " ", 
      RowBox[{"Grad", "[", 
       RowBox[{"fx", ",", "x"}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"For", " ", "nD", " ", "stuff", " ", "use", " ", "Grad"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Bf", " ", "=", " ", 
      RowBox[{"D", "[", 
       RowBox[{"fx", ",", "u"}], "]"}]}], " ", ";", 
     RowBox[{"(*", 
      RowBox[{"For", " ", "1", "D", " ", "stuff", " ", "use", " ", "D"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Q", " ", "=", " ", 
      RowBox[{"Grad", "[", 
       RowBox[{
        RowBox[{"Grad", "[", 
         RowBox[{"L", ",", "x"}], "]"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mf", " ", "=", " ", 
      RowBox[{"Grad", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"L", ",", "u"}], "]"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"R", " ", "=", " ", 
      RowBox[{"D", "[", 
       RowBox[{"L", ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myMatrix", "[", 
       RowBox[{"a_Integer", ",", "b_Integer"}], "]"}], ":=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"s", ",", "i", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "a"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "b"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"S", " ", "=", " ", 
      RowBox[{"myMatrix", "[", 
       RowBox[{"n", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", 
       RowBox[{"i", "<=", "n"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"j", " ", "<=", " ", "n"}], ",", 
         RowBox[{"j", " ", "++"}], " ", ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", " ", "!=", " ", "j"}], ",", " ", 
           RowBox[{
            SubscriptBox["s", 
             RowBox[{"i", ",", "j", " "}]], "=", " ", 
            SubscriptBox["s", 
             RowBox[{"j", ",", "i"}]]}], ",", "_"}], "]"}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ric", " ", "=", " ", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "2", "]"}], " ", "+", "  ", 
       RowBox[{
        RowBox[{"Af", "\[Transpose]"}], ".", "S"}], " ", "+", 
       RowBox[{"S", ".", "Af"}], " ", "-", 
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", 
         RowBox[{"S", ".", "Bf"}], ",", 
         RowBox[{
          RowBox[{"Bf", "\[Transpose]"}], ".", "S"}]}], " ", "]"}]}]}], " ", 
     ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "This", " ", "is", " ", "the", " ", "Syntax", " ", "for", " ", 
       "calculating", " ", "Outer", " ", "Products"}], " ", "*)"}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"M", " ", "=", " ", "0"}], ",", " ", 
       RowBox[{"R", " ", "=", " ", "1"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"RHS", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x", " ", "=", " ", "x0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"S", " ", "=", " ", 
      RowBox[{
       RowBox[{"NSolveValues", "[", 
        RowBox[{
         RowBox[{"ric", "==", "RHS"}], ",", 
         RowBox[{"Flatten", "@", "S"}]}], "]"}], "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
     "S"}]}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Output", " ", "format", " ", "is", " ", "still", " ", 
    RowBox[{"messy", ".", " ", "Needs"}], " ", "to", " ", "output", " ", "a", 
    " ", "matrix"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.86181433110098*^9, 3.861814348326473*^9}, 
   3.86181687601121*^9, {3.8619047525239058`*^9, 3.8619047628336105`*^9}, {
   3.8619048304510126`*^9, 3.861904911000283*^9}, {3.8619049942426925`*^9, 
   3.861905045741242*^9}, {3.8619051392633657`*^9, 3.8619051670514913`*^9}, {
   3.861905201789396*^9, 3.8619052340700836`*^9}, {3.861905345455502*^9, 
   3.861905380609274*^9}, {3.8619055263987017`*^9, 
   3.8619055497382483`*^9}},ExpressionUUID->"dc0f3990-4c42-40d0-9beb-\
314e9be51680"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"S", "=", " ", 
  RowBox[{"feedbackCalNumeric", "[", 
   RowBox[{"2", ",", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x2", ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "x1", "]"}]}], " ", "+", " ", "u"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     RowBox[{"u", "^", "2"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"0.1", ",", "0.1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8619054040287914`*^9, 3.861905420370571*^9}},
 CellLabel->
  "In[1499]:=",ExpressionUUID->"3acc370a-d719-40a8-acc1-1ab5f1529ad4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.9090500951481557`", ",", "0.41568123158430115`", ",", 
   "1.3532784130283768`"}], "}"}]], "Output",
 CellChangeTimes->{{3.861905413608731*^9, 3.8619054243293066`*^9}},
 CellLabel->
  "Out[1499]=",ExpressionUUID->"1fc1c981-844e-4641-b1ad-9f29f13a359d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"symSol", "[", "x1_", "]"}], " ", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SqrtBox[
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "x1", "]"}], "2"]}]], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", "x1", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "x1", "]"}], "2"]}]]}]}]]}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "x1", "]"}]}], "+", 
     SqrtBox[
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "x1", "]"}], "2"]}]]}], ",", 
    SqrtBox[
     RowBox[{"1", "-", 
      RowBox[{"2", " ", 
       RowBox[{"Cos", "[", "x1", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "x1", "]"}], "2"]}]]}]}]]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8619049580002694`*^9, 3.8619049764733686`*^9}, 
   3.8619050708182306`*^9, {3.861905180635153*^9, 3.861905193993885*^9}},
 CellLabel->
  "In[1435]:=",ExpressionUUID->"d5508ac1-9344-4e49-b7ce-d4170bab695b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"symSol", "[", "0.1", "]"}]], "Input",
 CellChangeTimes->{{3.861905212692912*^9, 3.8619052261046305`*^9}},
 CellLabel->
  "In[1436]:=",ExpressionUUID->"6d1ef516-54ee-4bfa-b26f-36ade736aa11"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.9090500951481557`", ",", "0.41568123158430115`", ",", 
   "1.3532784130283768`"}], "}"}]], "Output",
 CellChangeTimes->{3.86190522643852*^9},
 CellLabel->
  "Out[1436]=",ExpressionUUID->"dfd18bf2-e8b2-4ac3-aaeb-e6c9c7512c9f"]
}, Open  ]],

Cell["Calculate Feedback Numerically ", "Text",
 CellChangeTimes->{{3.8618145120221276`*^9, 3.8618145309990597`*^9}, {
  3.86181689308575*^9, 3.861816904411129*^9}, {3.861904159808238*^9, 
  3.8619041607829266`*^9}, {3.861904250605235*^9, 3.8619042559395304`*^9}, {
  3.861904768432824*^9, 3.8619047694474993`*^9}, {3.8619054877790394`*^9, 
  3.8619054920606728`*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"c836722a-abdd-40f5-91cf-5d13b6648301"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", " ", "=", " ", "1"}], ";", 
  RowBox[{"l", " ", "=", " ", "1"}], ";", " ", 
  RowBox[{"M", " ", "=", " ", "1"}], ";", 
  RowBox[{"m", " ", "=", " ", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ldynamics", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", "*", 
     RowBox[{"(", 
      RowBox[{"M", "+", "m"}], ")"}], "*", 
     RowBox[{"x2", "^", "2"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", "*", "m", "*", 
     RowBox[{"l", "^", "2"}], "*", 
     RowBox[{"\[Theta]2", "^", "2"}]}], " ", "+", " ", 
    RowBox[{"m", "*", "l", "*", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}], "*", "x2", "*", "\[Theta]2"}], 
    " ", "+", " ", 
    RowBox[{"m", "*", "g", "*", "l", "*", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], " ", "-", " ", 
    RowBox[{"u", "*", "x1"}]}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Note", ":", " ", 
    RowBox[{
    "u", " ", "is", " ", "a", " ", "scaled", " ", "version", " ", "of", " ", 
     "the", " ", "original", " ", "control", " ", "by", " ", "a", " ", 
     "factor", " ", "of", " ", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"M", "+", "m"}], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"fdot", "[", "s_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"s", ",", "x1"}], "]"}], "*", "x2"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"s", ",", "x2"}], "]"}], "*", "x2dot"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"s", ",", "\[Theta]1"}], "]"}], "*", "\[Theta]2"}], " ", "+", 
    " ", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"s", ",", "\[Theta]2"}], "]"}], "*", "\[Theta]2dot"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqn1", " ", "=", " ", 
   RowBox[{
    RowBox[{"fdot", "[", 
     RowBox[{"D", "[", 
      RowBox[{"Ldynamics", ",", "x2"}], "]"}], "]"}], " ", "-", " ", 
    RowBox[{"D", "[", 
     RowBox[{"Ldynamics", ",", "x1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqn2", " ", "=", " ", 
   RowBox[{
    RowBox[{"fdot", "[", 
     RowBox[{"D", "[", 
      RowBox[{"Ldynamics", ",", "\[Theta]2"}], "]"}], "]"}], " ", "-", " ", 
    RowBox[{"D", "[", 
     RowBox[{"Ldynamics", ",", "\[Theta]1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x2dot", ",", "\[Theta]2dot"}], "}"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"SolveValues", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eqn1", "==", "0"}], ",", 
        RowBox[{"eqn2", " ", "==", " ", "0"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2dot", ",", "\[Theta]2dot"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fx", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x2", ",", "x2dot", ",", "\[Theta]2", ",", "\[Theta]2dot"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2", ",", "\[Theta]1", ",", "\[Theta]2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3", ",", "\[Lambda]4"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    RowBox[{"u", "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Af", " ", "=", " ", 
   RowBox[{"Grad", "[", 
    RowBox[{"fx", ",", "x"}], "]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"For", " ", "nD", " ", "stuff", " ", "use", " ", "Grad"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Bf", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"fx", ",", "u"}], "]"}]}], " ", ";", 
  RowBox[{"(*", 
   RowBox[{"For", " ", "1", "D", " ", "stuff", " ", "use", " ", "D"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"Q", " ", "=", " ", 
   RowBox[{"Grad", "[", 
    RowBox[{
     RowBox[{"Grad", "[", 
      RowBox[{"L", ",", "x"}], "]"}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mf", " ", "=", " ", 
   RowBox[{"Grad", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"L", ",", "u"}], "]"}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"L", ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", " ", "=", " ", 
   RowBox[{"(", GridBox[{
      {"s11", "s12", "s13", "s14"},
      {"s12", "s22", "s23", "s24"},
      {"s13", "s23", "s33", "s34"},
      {"s14", "s24", "s34", "s44"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ric", " ", "=", " ", 
    RowBox[{"Q", " ", "+", "  ", 
     RowBox[{
      RowBox[{"Af", "\[Transpose]"}], ".", "S"}], " ", "+", 
     RowBox[{"S", ".", "Af"}], " ", "-", 
     RowBox[{"Outer", "[", 
      RowBox[{"Times", ",", 
       RowBox[{"S", ".", "Bf"}], ",", 
       RowBox[{
        RowBox[{"Bf", "\[Transpose]"}], ".", "S"}]}], " ", "]"}]}]}], " ", 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "is", " ", "the", " ", "Syntax", " ", "for", " ", 
    "calculating", " ", "Outer", " ", "Products"}], " ", "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"M", " ", "=", " ", "0"}], ",", " ", 
    RowBox[{"R", " ", "=", " ", "1"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHS", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", " ", "=", " ", "0.1"}], ";", 
   RowBox[{"x2", " ", "=", " ", "0.1"}], ";", 
   RowBox[{"\[Theta]1", " ", "=", " ", "0.1"}], ";", 
   RowBox[{"\[Theta]2", " ", "=", " ", "0.1"}], ";", 
   RowBox[{"u", " ", "=", " ", "0.1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Entering", " ", "State", " ", "Values"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "s11", ",", "s12", ",", "s13", ",", "s14", ",", "s22", ",", "s23", ",", 
     "s24", ",", "s33", ",", "s34", ",", "s44"}], "}"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"NSolveValues", "[", 
     RowBox[{
      RowBox[{"ric", "==", "RHS"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "s11", ",", "s12", ",", "s13", ",", "s14", ",", "s22", ",", "s23", ",",
         "s24", ",", "s33", ",", "s34", ",", "s44"}], "}"}]}], "]"}], " ", 
    "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", " ", "=", " ", 
   RowBox[{"(", GridBox[{
      {"s11", "s12", "s13", "s14"},
      {"s12", "s22", "s23", "s24"},
      {"s13", "s23", "s33", "s34"},
      {"s14", "s24", "s34", "s44"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8619054998461857`*^9, 3.86190551582408*^9}, {
  3.8619055953616753`*^9, 3.861905627188508*^9}, {3.861905713544923*^9, 
  3.8619057440281854`*^9}, {3.8619057752901993`*^9, 3.8619058048327622`*^9}, {
  3.8619058857629104`*^9, 3.861905895993641*^9}, {3.8619060261690598`*^9, 
  3.8619060869586415`*^9}},
 CellLabel->
  "In[1634]:=",ExpressionUUID->"b5fc6cea-89e2-4613-9a58-006b19275be3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "S", "]"}]], "Input",
 CellChangeTimes->{{3.861906106160508*^9, 3.8619061093794794`*^9}},
 CellLabel->
  "In[1654]:=",ExpressionUUID->"7b3ae22d-e478-418a-a762-e64f6d0bc66e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"4.4435359386511444`*^-15", "+", 
       RowBox[{"1.7678783434964074`*^-15", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "1.5368686718303118`*^-10"}], 
      RowBox[{"1.8269483995984066`*^-10", "+", 
       RowBox[{"2.951520240430808`*^-10", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "2.9490018555040715`*^-10"}], "+", 
       RowBox[{"1.8253895277038705`*^-10", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"-", "1.5368686718303118`*^-10"}], 
      RowBox[{
       RowBox[{"-", "6.2920915471099375`*^-6"}], "-", 
       RowBox[{"0.000022119565268888832`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.000042480177799411756`"}], "+", 
       RowBox[{"0.00001208374530086621`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.000012073434671902356`"}], "-", 
       RowBox[{"0.00004244393176141102`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"1.8269483995984066`*^-10", "+", 
       RowBox[{"2.951520240430808`*^-10", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.000042480177799411756`"}], "+", 
       RowBox[{"0.00001208374530086621`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.002194713976691126`"}], "+", 
       RowBox[{"2.348598798219699`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "2.235082826080607`"}], "+", 
       RowBox[{"0.000023186615831478048`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "2.9490018555040715`*^-10"}], "+", 
       RowBox[{"1.8253895277038705`*^-10", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.000012073434671902356`"}], "-", 
       RowBox[{"0.00004244393176141102`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "2.235082826080607`"}], "+", 
       RowBox[{"0.000023186615831478048`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0020318602866039787`"}], "-", 
       RowBox[{"2.1270517639757465`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.861906109826336*^9},
 CellLabel->
  "Out[1654]//MatrixForm=",ExpressionUUID->"0fe3f1ff-e30d-452d-97ce-\
9fca05275163"]
}, Open  ]]
},
WindowSize->{1440., 747.75},
WindowMargins->{{-6, Automatic}, {Automatic, -6}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0d050083-103d-4370-8c3c-80a036ae663b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 252, 5, 51, "Text",ExpressionUUID->"54324ec4-901a-43d0-a10a-39ff29734a3f"],
Cell[CellGroupData[{
Cell[835, 29, 7352, 206, 508, "Input",ExpressionUUID->"4663411f-0ad4-4651-90dc-0e8ed44cc4d4"],
Cell[8190, 237, 161, 3, 32, "Output",ExpressionUUID->"7d8d1e67-3db0-49ef-a8ac-ef6a2d2bb224"]
}, Open  ]],
Cell[8366, 243, 154, 3, 28, "Input",ExpressionUUID->"5f3d49a9-c4b6-4245-8de3-4c1154717fd3"],
Cell[8523, 248, 785, 12, 28, "Input",ExpressionUUID->"3f24608d-a622-4a00-ab08-ef45c75a1135"],
Cell[9311, 262, 338, 7, 51, "Text",ExpressionUUID->"818f44b8-eb81-448e-9c89-8e55e178d38f"],
Cell[9652, 271, 5203, 129, 334, "Input",ExpressionUUID->"62e43d9e-55cf-4f52-8714-78cd6c09b05f"],
Cell[14858, 402, 231, 4, 51, "Text",ExpressionUUID->"67fe12fe-b684-4f90-a08d-a3eca45f658c"],
Cell[CellGroupData[{
Cell[15114, 410, 911, 22, 48, "Input",ExpressionUUID->"3bc90743-56a5-4b59-a2ba-a0a7287f307e"],
Cell[16028, 434, 1093, 36, 43, "Output",ExpressionUUID->"6e376ed8-6fea-4439-a1c9-11b39911f128"]
}, Open  ]],
Cell[17136, 473, 458, 8, 51, "Text",ExpressionUUID->"065995be-0efc-4a4c-9d29-cbdd8ba9291d"],
Cell[17597, 483, 5148, 130, 353, "Input",ExpressionUUID->"dc0f3990-4c42-40d0-9beb-314e9be51680"],
Cell[CellGroupData[{
Cell[22770, 617, 639, 18, 28, "Input",ExpressionUUID->"3acc370a-d719-40a8-acc1-1ab5f1529ad4"],
Cell[23412, 637, 297, 7, 32, "Output",ExpressionUUID->"1fc1c981-844e-4641-b1ad-9f29f13a359d"]
}, Open  ]],
Cell[23724, 647, 1218, 38, 42, "Input",ExpressionUUID->"d5508ac1-9344-4e49-b7ce-d4170bab695b"],
Cell[CellGroupData[{
Cell[24967, 689, 213, 4, 28, "Input",ExpressionUUID->"6d1ef516-54ee-4bfa-b26f-36ade736aa11"],
Cell[25183, 695, 270, 7, 32, "Output",ExpressionUUID->"dfd18bf2-e8b2-4ac3-aaeb-e6c9c7512c9f"]
}, Open  ]],
Cell[25468, 705, 456, 7, 51, "Text",ExpressionUUID->"c836722a-abdd-40f5-91cf-5d13b6648301"],
Cell[25927, 714, 7680, 218, 587, "Input",ExpressionUUID->"b5fc6cea-89e2-4613-9a58-006b19275be3"],
Cell[CellGroupData[{
Cell[33632, 936, 215, 4, 28, "Input",ExpressionUUID->"7b3ae22d-e478-418a-a762-e64f6d0bc66e"],
Cell[33850, 942, 2586, 62, 102, "Output",ExpressionUUID->"0fe3f1ff-e30d-452d-97ce-9fca05275163"]
}, Open  ]]
}
]
*)

