(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     74378,       1650]
NotebookOptionsPosition[     72100,       1609]
NotebookOutlinePosition[     72536,       1626]
CellTagsIndexPosition[     72493,       1623]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Simulating", " ", "Matrix", " ", "Differential", " ", "Eqns"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"tEnd", "=", "10"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"X0", "=", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"-", "1"}], "0", "0", "0"},
        {"0", 
         RowBox[{"-", "1"}], "0", "0"},
        {"0", "0", 
         RowBox[{"-", "1"}], "0"},
        {"0", "0", "0", 
         RowBox[{"-", "1"}]}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A", "[", "t_", "]"}], " ", ":=", " ", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"-", "t"}], "0", "0", "0"},
        {"0", 
         RowBox[{"-", "t"}], "0", "0"},
        {"0", "0", 
         RowBox[{"-", "t"}], "0"},
        {"0", "0", "0", 
         RowBox[{"-", "t"}]}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Af", " ", "=", " ", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"-", "1"}], "0", "0", "0"},
        {"0", 
         RowBox[{"-", "1"}], "0", "0"},
        {"0", "0", 
         RowBox[{"-", "1"}], "0"},
        {"0", "0", "0", 
         RowBox[{"-", "1"}]}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Bf", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol", "=", 
     RowBox[{"x", "/.", " ", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"x", "'"}], "[", "t", "]"}], "==", 
           RowBox[{"Q", "  ", "+", " ", 
            RowBox[{
             RowBox[{"Af", "\[Transpose]"}], ".", 
             RowBox[{"x", "[", "t", "]"}]}], " ", "+", " ", 
            RowBox[{
             RowBox[{"x", "[", "t", "]"}], ".", "Af"}]}]}], ",", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], "==", "X0"}]}], "}"}], ",", "x", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tEnd"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "4"}], ";", 
    RowBox[{"j", " ", "=", " ", "4"}], ";"}], "\n", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"sol", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "j", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tEnd"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8626846858289833`*^9, 3.862684694315255*^9}, 
   3.8626847557715125`*^9, {3.8626848182044573`*^9, 3.8626848190441875`*^9}, {
   3.862684889645505*^9, 3.8626849377650485`*^9}, 3.8627556417111297`*^9, {
   3.8627557539433384`*^9, 3.86275576669927*^9}, {3.8627558489700317`*^9, 
   3.862755855807852*^9}, {3.8627558988501253`*^9, 3.862755899281987*^9}, {
   3.8627560028069696`*^9, 3.8627560650641155`*^9}, {3.862756097763687*^9, 
   3.862756113270743*^9}, {3.8627566895089693`*^9, 3.862756741623351*^9}, {
   3.8627568553930693`*^9, 3.862756856497717*^9}, {3.8627569840280423`*^9, 
   3.862757263701852*^9}, {3.862757446345603*^9, 3.862757451153071*^9}, {
   3.8627575164062595`*^9, 3.8627575195632515`*^9}, {3.8627575872496653`*^9, 
   3.862757689630017*^9}},
 FontWeight->"Bold",
 CellLabel->
  "In[647]:=",ExpressionUUID->"c7eccc41-d369-41b1-8e81-d21c6191e7c8"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwVlmc4Fv4Xxu3sveczhKyQROs5ZO9kFsrOyAglWSFEZiKU7UeEkBT6fq0i
K0mRtCRFKjsz//5vzrnu677O/TnXeXWIzn4WbjRUVFTs/8r/+8VjtSbXrixT
Ctm22HdwA15b4Qi24F+h6IX8bZi3qcdkMeedHfIKpfMdflyjXo9NtR9cq1Ze
oUy/qecoFqrHZRm2+YwmKxQKpVNDeqIOW+wt6kYxKxTpuDK3Ipc6XH1WRVhu
YYVyZtX5HX3Yfez8zhLT9q9Swib7lu4VVmPmvM/nAt6uUnxaz8aI+FXj+pO+
oh+nVymOq23vJ45UY9rx+EvN1H8ot8pb8q0m7uHSseZ9AQf+ULxwlSaX2D08
/ZpQ8aH4D2XwUA7nsepK7DU0l/b40hqFSWpgm0BfgbnTLlGk49coyNLtx/xE
OW42Y/iVmblG2WacXqRtLMcsLySM/GvXKMcEGesW3MrxvQELeumvaxTDc4U3
PvX+h3/1PrqUab5Oce2rgbrCMhzwNNbZT3qDYhOVJm9wqQSLT+kyrO7boNTw
F6xNnizBfTRMlWGwQTHVfaxw73AJ3g3JC9fsNiiqlNYnfVQl+G3zzajSpA0K
v3rtxwNJxVjz/n/5b39vUHQMP0TFVxRhrrye8WOPNinbFeX+ErSFGD1OjOjt
2qScr58V0BwpwN5jxqTjLzcpySqP9NOLC/BTvpeejrOblHGqNy+EoABfSnu7
FiK6Rdn4eGMZReTjz1dn+Wuitii160N5K0x3cJ0/6wlBg21KfXty1YplLu7P
5blUbb1NybtQseEmk4unu4QLtFy3KRrTx8uJWzlYWGjPD5/IbUqiyaL6pdIc
HNuuE9PeuE3xKR0Wvr12C1tzRzZ4kf5SmBrsu/RqsvFGwwLPk82/lN+53Y8X
jW5i3g9rGhZMOxSu2ejT36VvYkVGqjPf+HcoW39pmETobmIXe/Z7XCo7lMbm
4Hf7n2Tifjo5bfezO5SbR8hVaiqZON/KNYjj9Q4lP/W6A7v0DVx02XtWyYYK
zCs2eX000rFSG9NavAMVKPEFn1EVT8dtdBX0H12ooDVYoFmaNh1/Sp4iJPtT
wb50u5SUgTQsXuhgM3ONCsruuYZYuabh3C6zrqJWKtidpx0hui8VZ7Cp5nOT
qMFUlp22X/M6JlkMV3nKUIPdkq7lbr7ruC7L/3GbIjXsFX9n8PR7Eh6SqB7x
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
RkkILUmt7+yQYYIo1J7zkIT+B+USos8=
       "]]},
     Annotation[#, "Charting`Private`Tag$125448#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 10}, {-0.0771483813842253, 0.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.8627574833847895`*^9, 3.8627575203030157`*^9, 3.862757592734916*^9, {
   3.8627576382304068`*^9, 3.8627576474624624`*^9}, {3.8627576831310873`*^9, 
   3.862757690058878*^9}, 3.8627585526647787`*^9},
 FontWeight->"Bold",
 CellLabel->
  "Out[656]=",ExpressionUUID->"5b807e9a-659c-4e3b-abd9-e7f8f94f38d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tEnd", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Af", " ", "=", " ", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"-", "1"}], "0", "0", "0"},
      {"0", 
       RowBox[{"-", "1"}], "0", "0"},
      {"0", "0", 
       RowBox[{"-", "1"}], "0"},
      {"0", "0", "0", 
       RowBox[{"-", "1"}]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S0", " ", "=", " ", 
   RowBox[{"(", GridBox[{
      {"0", "0", "0", "0"},
      {"0", "0", "0", "0"},
      {"0", "0", "0", "0"},
      {"0", "0", "0", "0"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Bf", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol2", "=", 
   RowBox[{"S", "/.", " ", 
    RowBox[{"NDSolve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"S", "'"}], "[", "t", "]"}], "==", 
         RowBox[{"Q", " ", "+", " ", 
          RowBox[{
           RowBox[{"Af", "\[Transpose]"}], ".", 
           RowBox[{"S", "[", "t", "]"}]}], " ", "+", " ", 
          RowBox[{
           RowBox[{"S", "[", "t", "]"}], ".", "Af"}], " ", "-", " ", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"S", "[", "t", "]"}], ".", "Bf"}], ",", 
            RowBox[{
             RowBox[{"Bf", "\[Transpose]"}], ".", 
             RowBox[{"S", "[", "t", "]"}]}]}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"S", "[", "0", "]"}], "==", "S0"}]}], "}"}], ",", "S", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "tEnd"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", " ", "=", " ", "4"}], ";", 
  RowBox[{"j", " ", "=", " ", "4"}], ";"}], "\n", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"sol2", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], "[", 
     RowBox[{"[", "i", "]"}], "]"}], "[", 
    RowBox[{"[", "j", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "tEnd"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8627572536760473`*^9, 3.86275725404893*^9}, {
   3.8627578478275647`*^9, 3.862757881146937*^9}, 3.8627584897318497`*^9},
 FontWeight->"Bold",
 CellLabel->
  "In[638]:=",ExpressionUUID->"cb14f644-807a-43e1-b0a8-05a66f589ab4"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJxFz2lI0wEYBvDZtGLOcFqmqdt/Ji7nkX4IMvJIg8yLTJcw6djUzfJKcWBq
ZabpEG3V8GQMNQ0RZ8YM7FimpnktdGXRjMQ5RFPQ1tKptQryfV94ePh9e14m
P+tsyg4SiRT9N/9adoO/0z+5Ioj0/wY0RFQCcTl42+ZB1W2CuAaW9VYyrAgx
OD1QlLHGqANrNlOlK4w28C7tLGuZ0QNuHJFnf2MMgxWdYm2672ewMHiibilH
B87Ue+qUigUwhVnC+np0BVxlO8puvGQA87Xxr8hjP8HZb0r4WawNcNdVapzj
6V+4pyBt0S+BFLLtYvlW7I8lCzBJMxPyIp8M9sgV5MWzrcBzxppz1i93giP0
V67fz94NjpmTeNHpFPBiP7/obYc12Jc25Rp20QZMCTbypg17wKeWuWtuHFvw
p75kC643DdxdPnCBMKIFVqIZtdoOnJRT0E2ttwcfFnqpo3h7we/svK1FAfvA
zxXFDd5kB3CBBfvM2Bc0ZTo/PFO5H6xvZUrlhY5g6SEnyx6OE1hSLxjiEQfA
XOl5NXUevX6yxSRXOYN1+tC8vjIXcFOgv/M4zxXcUSqiCX3o4DJOUiTZiD4y
3dhWNs4A13o2dIxHEuCbvZW1kT3oaGdOy4g7E3wicyiRJkbLXfjuY0a0e/+j
6phEN/zPp489qUILDJYTw+yDYH7Xd0J8F51eHLcVcQ8tilN+pD5AlxtFVZJq
tCLAtFkjQ5tem6da29GSSWrlwBC6vjkj9c4wujlXHRY+in7qINkYVaOnufap
mg9ols4pbFaH9lPm0x/q0cdKtaaUeXQUS/Z4YRGdk0bQV1fRhcdvmZ4Y0KU2
s+9zjejazuaK9XV0U5Gl8NkGuj02JbRwC610G3QN+o1WGTxMZjP6DwbEFmI=

       "]]},
     Annotation[#, "Charting`Private`Tag$125093#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 10}, {-1., 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.8627584922510457`*^9},
 FontWeight->"Bold",
 CellLabel->
  "Out[646]=",ExpressionUUID->"8d5b2d3c-b109-4472-95c4-6625ee5069d2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Bf", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"S", "[", "t_", "]"}], " ", ":=", " ", 
     RowBox[{"(", GridBox[{
        {"t", "0", "0", "0"},
        {"0", "t", "0", "0"},
        {"0", "0", "t", "0"},
        {"0", "0", "0", "t"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"expr", "[", "t_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"Outer", "[", 
       RowBox[{"Times", ",", 
        RowBox[{
         RowBox[{"S", "[", "t", "]"}], ".", "Bf"}], ",", 
        RowBox[{
         RowBox[{"Bf", "\[Transpose]"}], ".", 
         RowBox[{"S", "[", "t", "]"}]}]}], "]"}], " ", "-", " ", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"S", "[", "t", "]"}], ".", "Bf"}], ",", 
        RowBox[{
         RowBox[{"Bf", "\[Transpose]"}], ".", 
         RowBox[{"S", "[", "t", "]"}]}]}], "]"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.862757717482132*^9, 3.8627577815057154`*^9}, {
  3.86275830288344*^9, 3.8627583482569704`*^9}, {3.862758445979802*^9, 
  3.862758474949565*^9}},
 FontWeight->"Bold",
 CellLabel->
  "In[633]:=",ExpressionUUID->"22c0dea7-cc48-4840-accd-42a6216763c0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"expr", "[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8627577692976093`*^9, 3.862757791453543*^9}},
 FontWeight->"Bold",
 CellLabel->
  "In[637]:=",ExpressionUUID->"7c42acab-9192-4aee-8e6c-6587aec0cf70"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.862757774880827*^9, 3.862757792082341*^9}, 
   3.8627584775027494`*^9},
 FontWeight->"Bold",
 CellLabel->
  "Out[637]//MatrixForm=",ExpressionUUID->"27d2668f-1612-4b8d-83ea-\
e21e53c4b8b9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"n", "=", "10"}], ";", 
     RowBox[{"\[Tau]", "=", "5"}], ";", 
     RowBox[{"\[Tau]1", "=", 
      RowBox[{"\[Tau]", "*", "1.25"}]}], ";", 
     RowBox[{"A", "=", "0.2"}], ";"}],
    FontWeight->"Plain"], 
   StyleBox["\n",
    FontWeight->"Plain"], 
   StyleBox[
    RowBox[{
     RowBox[{"ICs", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "\[Pi]", ",", "0"}], "}"}]}], ";"}],
    FontWeight->"Plain"], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Plain"], 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x1a", ",", "xdot1a", ",", "\[Theta]1a", ",", "\[Theta]dot1a", ",", 
       "u1a"}], "}"}], "=", 
     RowBox[{"ffCartPendulum", "[", 
      RowBox[{"ICs", ",", "n", ",", "\[Tau]", ",", "\[Tau]1", ",", "A"}], 
      "]"}]}], ";"}], "  ", "\n"}]}]], "Code",
 CellChangeTimes->{{3.862753555555438*^9, 3.862753569451007*^9}, 
   3.8627604928760157`*^9, 3.8627610552646613`*^9},
 FontWeight->"Bold",
 CellLabel->
  "In[919]:=",ExpressionUUID->"fe901aad-e224-41b9-a0d5-b9685cd0df2b"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"CalculateGainsIntegrate", "[", 
     RowBox[{
     "x1a_", ",", "xdot1a_", ",", "\[Theta]1a_", ",", "\[Theta]dot1a_", ",", 
      "u1a_", ",", "\[Tau]_", ",", "tCurrent_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "x", ",", "L", ",", "RHS", ",", "xdot", ",", "\[Theta]", ",", 
        "\[Theta]dot", ",", "u", ",", "K", ",", "S", ",", "soltn", ",", "Af", 
        ",", "Bf", ",", "Q", ",", "fx", ",", "xState", ",", "R", ",", "Mf", 
        ",", "x2dot", ",", "\[Theta]2dot", ",", "S0", ",", "sol2"}], "}"}], 
      ",", "\n", "\n", 
      RowBox[{
       RowBox[{"xState", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", "xdot", ",", "\[Theta]", ",", "\[Theta]dot"}], 
         "}"}]}], ";", "\n", 
       RowBox[{"x2dot", " ", "=", " ", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"A", " ", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], "^", "2"}]}]}], ")"}]}], 
         " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", 
           RowBox[{"A", " ", 
            RowBox[{"\[Theta]dot", "^", "2"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
           RowBox[{"A", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], ";", "\n", 
       RowBox[{"\[Theta]2dot", "=", " ", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"A", " ", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], "^", "2"}]}]}], ")"}]}], 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", 
              RowBox[{"A", " ", 
               RowBox[{"\[Theta]dot", "^", "2"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], 
          ")"}]}]}], ";", "\n", 
       RowBox[{"fx", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
         "xdot", ",", "x2dot", ",", "\[Theta]dot", ",", "\[Theta]2dot"}], 
         "}"}]}], ";", "\n", 
       RowBox[{"L", " ", "=", " ", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "*", 
         RowBox[{"u", "^", "2"}]}]}], ";", "\n", 
       RowBox[{"Af", " ", "=", " ", 
        RowBox[{"Grad", "[", 
         RowBox[{"fx", ",", "xState"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"For", " ", "nD", " ", "stuff", " ", "use", " ", "Grad"}], 
        "*)"}], "\n", 
       RowBox[{"Bf", " ", "=", " ", 
        RowBox[{"D", "[", 
         RowBox[{"fx", ",", "u"}], "]"}]}], " ", ";", 
       RowBox[{"(*", 
        RowBox[{"For", " ", "1", "D", " ", "stuff", " ", "use", " ", "D"}], 
        "*)"}], "\n", 
       RowBox[{"Q", " ", "=", " ", 
        RowBox[{"Grad", "[", 
         RowBox[{
          RowBox[{"Grad", "[", 
           RowBox[{"L", ",", "xState"}], "]"}], ",", "xState"}], "]"}]}], ";",
        "\n", 
       RowBox[{"Mf", " ", "=", " ", 
        RowBox[{"Grad", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"L", ",", "u"}], "]"}], ",", "xState"}], "]"}]}], ";", 
       "\n", 
       RowBox[{"R", " ", "=", " ", 
        RowBox[{"D", "[", 
         RowBox[{"L", ",", 
          RowBox[{"{", 
           RowBox[{"u", ",", "2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"S0", " ", "=", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"0", "0", "0", "0"},
            {"0", "0", "0", "0"},
            {"0", "0", "0", "0"},
            {"0", "0", "0", "0"}
           },
           GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}], ";", "\n", 
       RowBox[{
        RowBox[{"RHS", "[", "t_", "]"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "4", "]"}], " ", "+", " ", 
           RowBox[{
            RowBox[{"Af", "\[Transpose]"}], ".", 
            RowBox[{"S", "[", "t", "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"S", "[", "t", "]"}], ".", "Af"}], " ", "-", " ", 
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"S", "[", "t", "]"}], ".", "Bf"}], ",", 
             RowBox[{
              RowBox[{"Bf", "\[Transpose]"}], ".", 
              RowBox[{"S", "[", "t", "]"}]}]}], "]"}]}], ")"}], " ", "/.", 
         " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "->", " ", 
            RowBox[{"x1a", "[", "t", "]"}]}], ",", " ", 
           RowBox[{"xdot", " ", "->", " ", 
            RowBox[{"xdot1a", "[", "t", "]"}]}], ",", " ", 
           RowBox[{"\[Theta]", " ", "->", 
            RowBox[{"\[Theta]1a", "[", "t", "]"}]}], ",", " ", 
           RowBox[{"\[Theta]dot", " ", "->", " ", 
            RowBox[{"\[Theta]dot1a", "[", "t", "]"}]}], ",", " ", 
           RowBox[{"u", " ", "->", " ", 
            RowBox[{"u1a", "[", "t", "]"}]}]}], "}"}]}]}], ";", "\n", 
       RowBox[{"sol2", " ", "=", " ", 
        RowBox[{"S", " ", "/.", " ", 
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"S", "'"}], "[", "t", "]"}], "==", " ", 
              RowBox[{"RHS", "[", "t", "]"}]}], ",", 
             RowBox[{
              RowBox[{"S", "[", "0", "]"}], "==", "S0"}]}], "}"}], ",", "S", 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", 
             RowBox[{"\[Tau]", " ", "-", " ", "tCurrent"}]}], "}"}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", " ", "=", " ", 
        RowBox[{
         RowBox[{"sol2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"\[Tau]", " ", "-", " ", "tCurrent"}], "]"}]}], ";", "\n", 
       RowBox[{"K", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Bf", "\[Transpose]"}], ".", "S"}], ")"}], "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "->", " ", 
            RowBox[{"x1a", "[", 
             RowBox[{"\[Tau]", " ", "-", " ", "tCurrent"}], "]"}]}], ",", " ", 
           RowBox[{"xdot", " ", "->", " ", 
            RowBox[{"xdot1a", "[", 
             RowBox[{"\[Tau]", " ", "-", " ", "tCurrent"}], "]"}]}], ",", " ", 
           RowBox[{"\[Theta]", " ", "->", 
            RowBox[{"\[Theta]1a", "[", 
             RowBox[{"\[Tau]", " ", "-", " ", "tCurrent"}], "]"}]}], ",", " ", 
           RowBox[{"\[Theta]dot", " ", "->", " ", 
            RowBox[{"\[Theta]dot1a", "[", 
             RowBox[{"\[Tau]", " ", "-", " ", "tCurrent"}], "]"}]}], ",", " ", 
           RowBox[{"u", " ", "->", " ", 
            RowBox[{"u1a", "[", 
             RowBox[{"\[Tau]", " ", "-", " ", "tCurrent"}], "]"}]}]}], 
          "}"}]}]}]}]}], "\n", "]"}]}], "\[IndentingNewLine]"}]}]], "Code",
 CellChangeTimes->{{3.862753343189165*^9, 3.862753411389415*^9}, {
   3.8627553611496043`*^9, 3.8627553647834463`*^9}, {3.862755542386807*^9, 
   3.862755582254092*^9}, {3.862756179429644*^9, 3.8627562078485813`*^9}, 
   3.8627563320549693`*^9, {3.8627564690202875`*^9, 3.8627565488258357`*^9}, {
   3.8627568793814173`*^9, 3.8627568873778677`*^9}, 3.8627585165043135`*^9, {
   3.8627585965107956`*^9, 3.862758689290209*^9}, {3.862758834699833*^9, 
   3.8627588555911727`*^9}, {3.8627590963373947`*^9, 
   3.8627590998392787`*^9}, {3.8627594410134716`*^9, 
   3.8627594626865597`*^9}, {3.862759635094576*^9, 3.8627596377257366`*^9}, {
   3.862759669455618*^9, 3.8627597448635693`*^9}, 3.862759795914287*^9, {
   3.8627603319473376`*^9, 3.862760490473783*^9}, {3.8627605307139487`*^9, 
   3.862760536806006*^9}, {3.8627610047197795`*^9, 3.8627610478400292`*^9}, {
   3.8627611285982723`*^9, 3.862761147921111*^9}},
 FontWeight->"Bold",
 CellLabel->
  "In[923]:=",ExpressionUUID->"de4659f6-f5ec-48e8-8a00-bb447795b7be"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"n", "=", "10"}], ";", 
   RowBox[{"\[Tau]", "=", "5"}], ";", 
   RowBox[{"\[Tau]1", "=", 
    RowBox[{"\[Tau]", "*", "1.25"}]}], ";", 
   RowBox[{"A", "=", "0.2"}], ";"}],
  FontWeight->"Plain"], "\n", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"ICs", "=", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";"}],
   FontWeight->"Plain"], "\n", "\n", "\n", "\n"}], "\n", 
 RowBox[{
  RowBox[{"testFBLQR", "[", 
   RowBox[{
   "ICs_", ",", "\[Tau]_", ",", "\[Tau]1_", ",", "xff0_", ",", "xdotff0_", 
    ",", "\[Theta]ff0_", ",", "\[Theta]dotff0_", ",", "uff0_", ",", "A_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "K1", ",", "K2", ",", "K3", ",", "K4", ",", "eq", ",", "init", ",", 
      "\[Theta]", ",", "\[Theta]dot", ",", "\[Theta]ff", ",", "\[Theta]dotff",
       ",", "x", ",", "xdot", ",", "xff", ",", "xdotff", ",", "uff", ",", "t",
       ",", "ufb", ",", "u", ",", "\[Theta]s", ",", "\[Theta]dots", ",", "xs",
       ",", "xdots", ",", "us", ",", "\[Kappa]1", ",", "\[Kappa]2", ",", 
      "\[Kappa]3", ",", "\[Kappa]4", ",", "J"}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"\[Kappa]1", "=", 
      RowBox[{"\[Kappa]2", "=", "3"}]}], ";", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"lqr", " ", "for", " ", "q"}], "=", 
       RowBox[{"r", " ", "for", " ", "balancing", " ", "pendulum"}]}], " ", 
      "*)"}], "\n", 
     RowBox[{"\[Kappa]3", " ", "=", " ", 
      RowBox[{"-", "0.1"}]}], ";", 
     RowBox[{"\[Kappa]4", " ", "=", " ", 
      RowBox[{"-", "0.65"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"xff", "[", "t_", "]"}], ":=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xff0", "[", "t", "]"}], ",", 
           RowBox[{"0", "<=", "t", "<=", "\[Tau]"}]}], "}"}], "}"}], ",", 
        "0"}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"xdotff", "[", "t_", "]"}], ":=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xdotff0", "[", "t", "]"}], ",", 
           RowBox[{"0", "<=", "t", "<=", "\[Tau]"}]}], "}"}], "}"}], ",", 
        "0"}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"\[Theta]ff", "[", "t_", "]"}], ":=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Theta]ff0", "[", "t", "]"}], ",", 
           RowBox[{"0", "<=", "t", "<=", "\[Tau]"}]}], "}"}], "}"}], ",", 
        "\[Pi]"}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"\[Theta]dotff", "[", "t_", "]"}], ":=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Theta]dotff0", "[", "t", "]"}], ",", 
           RowBox[{"0", "<=", "t", "<=", "\[Tau]"}]}], "}"}], "}"}], ",", 
        "0"}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"uff", "[", "t_", "]"}], ":=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"uff0", "[", "t", "]"}], ",", 
           RowBox[{"0", "<=", "t", "<=", "\[Tau]"}]}], "}"}], "}"}], ",", 
        "0"}], "]"}]}], ";", "\n", "\n", 
     RowBox[{
      RowBox[{"ufb", "[", "t_", "]"}], ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "K", "}"}], ",", "\n", 
        RowBox[{
         RowBox[{"K", " ", "=", " ", 
          RowBox[{"CalculateGainsIntegrate", "[", 
           RowBox[{
           "x1a", ",", "xdot1a", ",", "\[Theta]1a", ",", "\[Theta]dot1a", ",",
             "u1a", ",", "\[Tau]", ",", "t"}], "]"}]}], ";", "\n", 
         RowBox[{"Piecewise", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"K", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Theta]ff", "[", "t", "]"}], "-", 
                  RowBox[{"\[Theta]", "[", "t", "]"}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"K", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], " ", "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Theta]dotff", "[", "t", "]"}], "-", 
                  RowBox[{"\[Theta]dot", "[", "t", "]"}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"K", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"xff", "[", "t", "]"}], "-", 
                  RowBox[{"x", "[", "t", "]"}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"K", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "*", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"xdotff", "[", "t", "]"}], "-", 
                  RowBox[{"xdot", "[", "t", "]"}]}], ")"}]}]}], ",", 
              RowBox[{"0", "<=", "t", "<=", "\[Tau]"}]}], "}"}], "}"}], ",", 
           RowBox[{
            RowBox[{"\[Kappa]1", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Theta]ff", "[", "t", "]"}], "-", 
               RowBox[{"\[Theta]", "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{"\[Kappa]2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Theta]dotff", "[", "t", "]"}], "-", 
               RowBox[{"\[Theta]dot", "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{"\[Kappa]3", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"xff", "[", "t", "]"}], "-", 
               RowBox[{"x", "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{"\[Kappa]4", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"xdotff", "[", "t", "]"}], "-", 
               RowBox[{"xdot", "[", "t", "]"}]}], ")"}]}]}]}], "]"}]}]}], 
       "\n", "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"u", "[", "t_", "]"}], ":=", 
      RowBox[{
       RowBox[{"uff", "[", "t", "]"}], "+", 
       RowBox[{"ufb", "[", "t", "]"}]}]}], ";", "\n", 
     RowBox[{"eq", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"x", "'"}], "[", "t", "]"}], "==", 
         RowBox[{"xdot", "[", "t", "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"xdot", "'"}], "[", "t", "]"}], "==", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"A", " ", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "^", "2"}]}]}], 
            ")"}]}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"u", "[", "t", "]"}], "+", 
            RowBox[{"A", " ", 
             RowBox[{
              RowBox[{"\[Theta]dot", "[", "t", "]"}], "^", "2"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"A", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "==", 
         RowBox[{"\[Theta]dot", "[", "t", "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Theta]dot", "'"}], "[", "t", "]"}], "==", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"A", " ", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "^", "2"}]}]}], 
            ")"}]}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"u", "[", "t", "]"}], "+", 
               RowBox[{"A", " ", 
                RowBox[{
                 RowBox[{"\[Theta]dot", "[", "t", "]"}], "^", "2"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
           ")"}]}]}]}], "}"}]}], ";", "\n", 
     RowBox[{"init", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", "0", "]"}], "==", 
         RowBox[{"ICs", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"xdot", "[", "0", "]"}], "==", 
         RowBox[{"ICs", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"\[Theta]", "[", "0", "]"}], "==", 
         RowBox[{"ICs", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"\[Theta]dot", "[", "0", "]"}], "==", 
         RowBox[{"ICs", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xs", ",", "xdots", ",", "\[Theta]s", ",", "\[Theta]dots"}], 
       "}"}], "=", 
      RowBox[{"NDSolveValue", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"eq", ",", "init"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "xdot", ",", "\[Theta]", ",", "\[Theta]dot"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "\[Tau]1"}], "}"}], ",", 
        RowBox[{"Method", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<DiscontinuityProcessing\>\"", "->", "None"}], 
          "}"}]}]}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"us", "[", "t_", "]"}], ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "K", "}"}], ",", "\n", 
        RowBox[{
         RowBox[{"K", " ", "=", " ", 
          RowBox[{"CalculateGainsIntegrate", "[", 
           RowBox[{
           "x1a", ",", "xdot1a", ",", "\[Theta]1a", ",", "\[Theta]dot1a", ",",
             "u1a", ",", "\[Tau]", ",", "t"}], "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{"uff", "[", "t", "]"}], " ", "+", " ", 
          RowBox[{"Piecewise", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"K", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Theta]ff", "[", "t", "]"}], "-", 
                   RowBox[{"\[Theta]s", "[", "t", "]"}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"K", "[", 
                  RowBox[{"[", "4", "]"}], "]"}], " ", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Theta]dotff", "[", "t", "]"}], "-", 
                   RowBox[{"\[Theta]dots", "[", "t", "]"}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"K", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"xff", "[", "t", "]"}], "-", 
                   RowBox[{"xs", "[", "t", "]"}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"K", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], " ", "*", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"xdotff", "[", "t", "]"}], "-", 
                   RowBox[{"xdots", "[", "t", "]"}]}], ")"}]}]}], ",", 
               RowBox[{"0", "<=", "t", "<=", "\[Tau]"}]}], "}"}], "}"}], ",", 
            RowBox[{
             RowBox[{"\[Kappa]1", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Theta]ff", "[", "t", "]"}], "-", 
                RowBox[{"\[Theta]s", "[", "t", "]"}]}], ")"}]}], "+", 
             RowBox[{"\[Kappa]2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Theta]dotff", "[", "t", "]"}], "-", 
                RowBox[{"\[Theta]dots", "[", "t", "]"}]}], ")"}]}], "+", 
             RowBox[{"\[Kappa]3", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xff", "[", "t", "]"}], "-", 
                RowBox[{"xs", "[", "t", "]"}]}], ")"}]}], "+", 
             RowBox[{"\[Kappa]4", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xdotff", "[", "t", "]"}], "-", 
                RowBox[{"xdots", "[", "t", "]"}]}], ")"}]}]}]}], "]"}]}]}]}], 
       "\n", "]"}]}], ";", "\n", 
     RowBox[{"J", " ", "=", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"us", "[", "t", "]"}], "^", "2"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "\[Tau]"}], "}"}]}], "]"}]}], ";", "\n", 
     RowBox[{"{", 
      RowBox[{
      "xs", ",", "xdots", ",", "\[Theta]s", ",", "\[Theta]dots", ",", "us", 
       ",", "J"}], "}"}]}]}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.8627595136413097`*^9, 3.862759571890732*^9}, {
   3.862760585442494*^9, 3.8627606491901627`*^9}, {3.862761175383353*^9, 
   3.8627611814514165`*^9}, {3.8627612544121485`*^9, 
   3.8627614746998954`*^9}, {3.8627615107314043`*^9, 3.8627615122219296`*^9}, 
   3.862761935428962*^9, {3.862762119224346*^9, 3.862762123359029*^9}},
 FontWeight->"Bold",
 CellLabel->
  "In[934]:=",ExpressionUUID->"8506dbcc-42be-44f2-944c-87c1e0738e3a"],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"n", "=", "10"}], ";", 
   RowBox[{"\[Tau]", "=", "5"}], ";", 
   RowBox[{"\[Tau]1", "=", 
    RowBox[{"\[Tau]", "*", "1.25"}]}], ";", 
   RowBox[{"A", "=", "0.2"}], ";"}],
  FontWeight->"Plain"], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"ICs", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";"}],
  FontWeight->"Plain"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x1a", ",", "xdot1a", ",", "\[Theta]1a", ",", "\[Theta]dot1a", ",", 
      "u1a"}], "}"}], "=", 
    RowBox[{"ffCartPendulum", "[", 
     RowBox[{"ICs", ",", "n", ",", "\[Tau]", ",", "\[Tau]1", ",", "A"}], 
     "]"}]}], ";"}], "  "}], "\n", 
 RowBox[{"testFBLQR", "[", 
  RowBox[{
  "ICs", ",", "\[Tau]", ",", "\[Tau]1", ",", "x1a", ",", "xdot1a", ",", 
   "\[Theta]1a", ",", "\[Theta]dot1a", ",", "u1a", ",", "A"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8627614795873375`*^9, 3.862761567008457*^9}, {
  3.8627620959027853`*^9, 3.862762100476325*^9}},
 CellLabel->
  "In[938]:=",ExpressionUUID->"1cec1cbb-431f-4aa3-b588-95318ba301ec"],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "lstol", 
   "\"The line search decreased the step size to within tolerance specified \
by AccuracyGoal and PrecisionGoal but was unable to find a sufficient \
decrease in the merit function. You may need more than \
\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\) digits of working precision to \
meet these tolerances.\"", 2, 940, 855, 17520192442800055591, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.86276157443009*^9},
 CellLabel->
  "During evaluation of \
In[938]:=",ExpressionUUID->"180507fb-52eb-4ba8-a33c-578eb3fe5b6a"],

Cell[BoxData[
 TemplateBox[{
  "NDSolveValue", "ndnum", 
   "\"Encountered non-numerical value for a derivative at \\!\\(\\*RowBox[{\\\
\"t$189003\\\"}]\\) == \\!\\(\\*RowBox[{\\\"0.`\\\"}]\\).\"", 2, 941, 856, 
   17520192442800055591, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8627615744500833`*^9},
 CellLabel->
  "During evaluation of \
In[938]:=",ExpressionUUID->"f94ef94b-f9ed-4e19-aef7-e9385d37fa9e"],

Cell[BoxData[
 TemplateBox[{
  "Set", "shape", 
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"xs$189003\\\", \\\",\\\", \
\\\"xdots$189003\\\", \\\",\\\", \\\"\[Theta]s$189003\\\", \\\",\\\", \\\"\
\[Theta]dots$189003\\\"}], \\\"}\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"NDSolveValue\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{SuperscriptBox[\\\"x$189003\\\", \\\"\[Prime]\\\", \
Rule[MultilineFunction, None]], \\\"[\\\", \\\"t$189003\\\", \\\"]\\\"}], \
\\\"\[Equal]\\\", RowBox[{\\\"xdot$189003\\\", \\\"[\\\", \\\"t$189003\\\", \
\\\"]\\\"}]}], \\\",\\\", RowBox[{RowBox[{SuperscriptBox[\\\"xdot$189003\\\", \
\\\"\[Prime]\\\", Rule[MultilineFunction, None]], \\\"[\\\", \
\\\"t$189003\\\", \\\"]\\\"}], \\\"\[Equal]\\\", FractionBox[RowBox[{RowBox[{\
\\\"Piecewise\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \
\\\",\\\", \\\"0\\\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"Piecewise\\\", \\\
\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\
\"0.2`\\\", \\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \
\\\", RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"+\\\", \
RowBox[{\\\"0.2`\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \
\\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], RowBox[{\\\"1\\\", \\\
\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}]]}], \\\",\\\", \
RowBox[{RowBox[{SuperscriptBox[\\\"\[Theta]$189003\\\", \\\"\[Prime]\\\", \
Rule[MultilineFunction, None]], \\\"[\\\", \\\"t$189003\\\", \\\"]\\\"}], \
\\\"\[Equal]\\\", RowBox[{\\\"\[Theta]dot$189003\\\", \\\"[\\\", \\\"t$189003\
\\\", \\\"]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{SuperscriptBox[\\\"\[Theta]dot$189003\\\", \\\"\[Prime]\\\", \
Rule[MultilineFunction, None]], \\\"[\\\", \\\"t$189003\\\", \\\"]\\\"}], \
\\\"\[Equal]\\\", FractionBox[RowBox[{RowBox[{\\\"-\\\", RowBox[{\\\"Sin\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}]}], \\\"-\\\", RowBox[{RowBox[{\\\"Cos\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\" \\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], \
RowBox[{\\\"1\\\", \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \
\\\"]\\\"}]}]]}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"x$189003\\\", \\\"[\\\", \\\"0\\\", \\\"]\\\"}], \
\\\"\[Equal]\\\", \\\"0\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"xdot$189003\\\", \\\"[\\\", \\\"0\\\", \\\"]\\\"}], \\\"\
\[Equal]\\\", \\\"0\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"\[Theta]$189003\\\", \\\"[\\\", \\\"0\\\", \\\"]\\\"}], \
\\\"\[Equal]\\\", \\\"0\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"\[Theta]dot$189003\\\", \\\"[\\\", \\\"0\\\", \
\\\"]\\\"}], \\\"\[Equal]\\\", \\\"0\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"x$189003\\\", \\\",\\\", \
\\\"xdot$189003\\\", \\\",\\\", \\\"\[Theta]$189003\\\", \\\",\\\", \\\"\
\[Theta]dot$189003\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"t$189003\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"6.25`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"Method\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\\\\\\\"DiscontinuityProcessing\\\\\\\"\\\", \
\\\"\[Rule]\\\", \\\"None\\\"}], \\\"}\\\"}]}]}], \\\"]\\\"}]\\) are not the \
same shape.\"", 2, 941, 857, 17520192442800055591, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8627615744630785`*^9},
 CellLabel->
  "During evaluation of \
In[938]:=",ExpressionUUID->"cb02dd8a-3b85-4e4c-bf7c-41662205812b"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "inumr", 
   "\"The integrand \\!\\(\\*SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{RowBox[{\\\"Piecewise\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\"}\\\"}], \\\",\\\", \\\"0\\\"}], \
\\\"]\\\"}], RowBox[{\\\"0\\\", \\\"\[LessEqual]\\\", \\\"t$189003\\\", \\\"\
\[LessEqual]\\\", \\\"5\\\"}]}, {\\\"0\\\", TagBox[\\\"True\\\", \
\\\"PiecewiseDefault\\\", Rule[AutoDelete, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 1.2`], Rule[ColumnWidths, Automatic], \
Rule[AllowedDimensions, List[2, Automatic]], Rule[Selectable, True], \
Rule[Editable, True]]}}, Rule[ColumnAlignments, List[Left]], \
Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}], \\\"+\\\", \
RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{RowBox[{RowBox[{\\\"cartPendulum`Private`xdotff$189000\\\", \\\" \\\
\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\
\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"+\\\", \
RowBox[{\\\"cartPendulum`Private`xff$189000\\\", \\\" \\\", \
RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"+\\\", \
RowBox[{\\\"cartPendulum`Private`\[Theta]dotff$189000\\\", \\\" \\\", \
RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"+\\\", \
RowBox[{\\\"cartPendulum`Private`\[Theta]ff$189000\\\", \\\" \\\", RowBox[{\\\
\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], RowBox[{\\\"0\\\", \
\\\"\[LessEqual]\\\", \\\"t$189003\\\", \\\"\[LessEqual]\\\", \\\"5\\\"}]}, \
{RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"0.65`\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"Piecewise\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", \\\"0\\\"}], \\\"]\\\"}], \
\\\"-\\\", RowBox[{\\\"xdots$189003\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}]}], \\\"-\\\", RowBox[{\\\"0.1`\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Piecewise\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\",\\\", \\\"0\\\"}], \\\"]\\\"}], \\\"-\\\", RowBox[{\\\"xs$189003\
\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}], \\\"+\\\", \
RowBox[{\\\"3\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Piecewise\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\",\\\", \\\"0\\\"}], \\\"]\\\"}], \\\"-\\\", \
RowBox[{\\\"\[Theta]dots$189003\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\
\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}], \
\\\"+\\\", RowBox[{\\\"3\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Piecewise\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\",\\\", \\\"\[Pi]\\\"}], \\\"]\\\"}], \\\"-\\\", RowBox[{\\\"\
\[Theta]s$189003\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}]}], TagBox[\\\"True\\\
\", \\\"PiecewiseDefault\\\", Rule[AutoDelete, True]]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 1.2`], \
Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, Automatic]], \
Rule[Selectable, True], Rule[Editable, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], \\\")\\\"}], \
\\\"2\\\"]\\) has evaluated to non-numerical values for all sampling points \
in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"0.5`\\\"}], \\\"}\\\"}], \\\"}\\\"}]\\).\"",
    2, 941, 858, 17520192442800055591, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.862761574519061*^9},
 CellLabel->
  "During evaluation of \
In[938]:=",ExpressionUUID->"317b5ca3-f884-4928-9ce6-5ee75c935796"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "inumr", 
   "\"The integrand \\!\\(\\*SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{RowBox[{\\\"Piecewise\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\"}\\\"}], \\\",\\\", \\\"0\\\"}], \
\\\"]\\\"}], RowBox[{\\\"0\\\", \\\"\[LessEqual]\\\", \\\"t$189003\\\", \\\"\
\[LessEqual]\\\", \\\"5\\\"}]}, {\\\"0\\\", TagBox[\\\"True\\\", \
\\\"PiecewiseDefault\\\", Rule[AutoDelete, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 1.2`], Rule[ColumnWidths, Automatic], \
Rule[AllowedDimensions, List[2, Automatic]], Rule[Selectable, True], \
Rule[Editable, True]]}}, Rule[ColumnAlignments, List[Left]], \
Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}], \\\"+\\\", \
RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{RowBox[{RowBox[{\\\"cartPendulum`Private`xdotff$189000\\\", \\\" \\\
\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\
\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"+\\\", \
RowBox[{\\\"cartPendulum`Private`xff$189000\\\", \\\" \\\", \
RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"+\\\", \
RowBox[{\\\"cartPendulum`Private`\[Theta]dotff$189000\\\", \\\" \\\", \
RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"+\\\", \
RowBox[{\\\"cartPendulum`Private`\[Theta]ff$189000\\\", \\\" \\\", RowBox[{\\\
\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], RowBox[{\\\"0\\\", \
\\\"\[LessEqual]\\\", \\\"t$189003\\\", \\\"\[LessEqual]\\\", \\\"5\\\"}]}, \
{RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"0.65`\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"Piecewise\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", \\\"0\\\"}], \\\"]\\\"}], \
\\\"-\\\", RowBox[{\\\"xdots$189003\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}]}], \\\"-\\\", RowBox[{\\\"0.1`\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Piecewise\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\",\\\", \\\"0\\\"}], \\\"]\\\"}], \\\"-\\\", RowBox[{\\\"xs$189003\
\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}], \\\"+\\\", \
RowBox[{\\\"3\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Piecewise\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\",\\\", \\\"0\\\"}], \\\"]\\\"}], \\\"-\\\", \
RowBox[{\\\"\[Theta]dots$189003\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\
\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}], \
\\\"+\\\", RowBox[{\\\"3\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Piecewise\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\",\\\", \\\"\[Pi]\\\"}], \\\"]\\\"}], \\\"-\\\", RowBox[{\\\"\
\[Theta]s$189003\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}]}], TagBox[\\\"True\\\
\", \\\"PiecewiseDefault\\\", Rule[AutoDelete, True]]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 1.2`], \
Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, Automatic]], \
Rule[Selectable, True], Rule[Editable, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], \\\")\\\"}], \
\\\"2\\\"]\\) has evaluated to non-numerical values for all sampling points \
in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"0.5`\\\"}], \\\"}\\\"}], \\\"}\\\"}]\\).\"",
    2, 941, 859, 17520192442800055591, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.862761574536055*^9},
 CellLabel->
  "During evaluation of \
In[938]:=",ExpressionUUID->"20622671-ee66-4956-82f2-353279389280"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "inumr", 
   "\"The integrand \\!\\(\\*SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{RowBox[{\\\"Piecewise\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\"}\\\"}], \\\",\\\", \\\"0\\\"}], \
\\\"]\\\"}], RowBox[{\\\"0\\\", \\\"\[LessEqual]\\\", \\\"t$189003\\\", \\\"\
\[LessEqual]\\\", \\\"5\\\"}]}, {\\\"0\\\", TagBox[\\\"True\\\", \
\\\"PiecewiseDefault\\\", Rule[AutoDelete, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 1.2`], Rule[ColumnWidths, Automatic], \
Rule[AllowedDimensions, List[2, Automatic]], Rule[Selectable, True], \
Rule[Editable, True]]}}, Rule[ColumnAlignments, List[Left]], \
Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}], \\\"+\\\", \
RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{RowBox[{RowBox[{\\\"cartPendulum`Private`xdotff$189000\\\", \\\" \\\
\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\
\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"+\\\", \
RowBox[{\\\"cartPendulum`Private`xff$189000\\\", \\\" \\\", \
RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"+\\\", \
RowBox[{\\\"cartPendulum`Private`\[Theta]dotff$189000\\\", \\\" \\\", \
RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"+\\\", \
RowBox[{\\\"cartPendulum`Private`\[Theta]ff$189000\\\", \\\" \\\", RowBox[{\\\
\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], RowBox[{\\\"0\\\", \
\\\"\[LessEqual]\\\", \\\"t$189003\\\", \\\"\[LessEqual]\\\", \\\"5\\\"}]}, \
{RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"0.65`\\\"}], \\\" \\\", RowBox[{\\\"(\
\\\", RowBox[{RowBox[{\\\"Piecewise\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", \\\"0\\\"}], \\\"]\\\"}], \
\\\"-\\\", RowBox[{\\\"xdots$189003\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}]}], \\\"-\\\", RowBox[{\\\"0.1`\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Piecewise\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\",\\\", \\\"0\\\"}], \\\"]\\\"}], \\\"-\\\", RowBox[{\\\"xs$189003\
\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}], \\\"+\\\", \
RowBox[{\\\"3\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Piecewise\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\",\\\", \\\"0\\\"}], \\\"]\\\"}], \\\"-\\\", \
RowBox[{\\\"\[Theta]dots$189003\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\
\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}], \
\\\"+\\\", RowBox[{\\\"3\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Piecewise\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\",\\\", \\\"\[Pi]\\\"}], \\\"]\\\"}], \\\"-\\\", RowBox[{\\\"\
\[Theta]s$189003\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}]}], TagBox[\\\"True\\\
\", \\\"PiecewiseDefault\\\", Rule[AutoDelete, True]]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 1.2`], \
Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, Automatic]], \
Rule[Selectable, True], Rule[Editable, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], \\\")\\\"}], \
\\\"2\\\"]\\) has evaluated to non-numerical values for all sampling points \
in the region with boundaries \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"0.5`\\\"}], \\\"}\\\"}], \\\"}\\\"}]\\).\"",
    2, 941, 860, 17520192442800055591, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.862761574548052*^9},
 CellLabel->
  "During evaluation of \
In[938]:=",ExpressionUUID->"d6fecf55-23e4-4f90-afb8-cd3fff184a63"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"inumr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 941, 861, 17520192442800055591, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8627615745610476`*^9},
 CellLabel->
  "During evaluation of \
In[938]:=",ExpressionUUID->"ccbacd75-520f-4a06-a380-86dc107bab00"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "xs$189003", ",", "xdots$189003", ",", "\[Theta]s$189003", ",", 
   "\[Theta]dots$189003", ",", "us$189003", ",", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"us$189003", "[", "t$189003", "]"}], "2"], ",", 
     RowBox[{"{", 
      RowBox[{"t$189003", ",", "0", ",", "5"}], "}"}]}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8627615499199057`*^9, 3.8627615746220284`*^9}},
 CellLabel->
  "Out[941]=",ExpressionUUID->"3a0c8437-ae54-420b-9385-fdf5f4624397"]
}, Open  ]]
},
WindowSize->{1440., 747.75},
WindowMargins->{{-6, Automatic}, {Automatic, -6}},
Magnification:>0.9 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ff3211f5-b19c-4562-8fda-d7a1542517a4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4103, 114, 381, "Input",ExpressionUUID->"c7eccc41-d369-41b1-8e81-d21c6191e7c8"],
Cell[4686, 138, 13023, 234, 205, "Output",ExpressionUUID->"5b807e9a-659c-4e3b-abd9-e7f8f94f38d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17746, 377, 3010, 90, 291, "Input",ExpressionUUID->"cb14f644-807a-43e1-b0a8-05a66f589ab4"],
Cell[20759, 469, 2670, 65, 207, "Output",ExpressionUUID->"8d5b2d3c-b109-4472-95c4-6625ee5069d2"]
}, Open  ]],
Cell[23444, 537, 1496, 43, 150, "Input",ExpressionUUID->"22c0dea7-cc48-4840-accd-42a6216763c0"],
Cell[CellGroupData[{
Cell[24965, 584, 266, 6, 26, "Input",ExpressionUUID->"7c42acab-9192-4aee-8e6c-6587aec0cf70"],
Cell[25234, 592, 768, 23, 86, "Output",ExpressionUUID->"27d2668f-1612-4b8d-83ea-e21e53c4b8b9"]
}, Open  ]],
Cell[26017, 618, 1212, 37, 125, "Code",ExpressionUUID->"fe901aad-e224-41b9-a0d5-b9685cd0df2b"],
Cell[27232, 657, 8638, 208, 411, "Code",ExpressionUUID->"de4659f6-f5ec-48e8-8a00-bb447795b7be"],
Cell[35873, 867, 13895, 358, 509, "Code",ExpressionUUID->"8506dbcc-42be-44f2-944c-87c1e0738e3a"],
Cell[CellGroupData[{
Cell[49793, 1229, 1140, 33, 77, "Input",ExpressionUUID->"1cec1cbb-431f-4aa3-b588-95318ba301ec"],
Cell[50936, 1264, 599, 12, 26, "Message",ExpressionUUID->"180507fb-52eb-4ba8-a33c-578eb3fe5b6a"],
Cell[51538, 1278, 437, 10, 26, "Message",ExpressionUUID->"f94ef94b-f9ed-4e19-aef7-e9385d37fa9e"],
Cell[51978, 1290, 4438, 66, 98, "Message",ExpressionUUID->"cb02dd8a-3b85-4e4c-bf7c-41662205812b"],
Cell[56419, 1358, 4883, 72, 54, "Message",ExpressionUUID->"317b5ca3-f884-4928-9ce6-5ee75c935796"],
Cell[61305, 1432, 4883, 72, 54, "Message",ExpressionUUID->"20622671-ee66-4956-82f2-353279389280"],
Cell[66191, 1506, 4883, 72, 54, "Message",ExpressionUUID->"d6fecf55-23e4-4f90-afb8-cd3fff184a63"],
Cell[71077, 1580, 461, 10, 26, "Message",ExpressionUUID->"ccbacd75-520f-4a06-a380-86dc107bab00"],
Cell[71541, 1592, 543, 14, 33, "Output",ExpressionUUID->"3a0c8437-ae54-420b-9385-fdf5f4624397"]
}, Open  ]]
}
]
*)

